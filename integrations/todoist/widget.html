{# Todoist tasks widget - Command Center style #}
<div class="h-full flex flex-col">
  {# Widget header with telemetry style #}
  <div
    class="flex items-center justify-between mb-3 pb-2 border-b border-command-border"
  >
    <div class="flex items-center gap-3">
      <div class="w-1 h-4 bg-command-amber"></div>
      <h2 class="text-sm font-bold tracking-wider text-white uppercase">
        Task_Queue
      </h2>
    </div>
    <div class="flex items-center gap-4 text-[0.65rem] tracking-wider">
      <div class="flex items-center gap-1.5">
        <span class="text-command-cyan opacity-60">TOTAL</span>
        <span class="font-bold text-command-amber">{{ data.total_tasks }}</span>
      </div>
      <div class="flex items-center gap-1.5">
        <span class="text-command-cyan opacity-60">PROJ</span>
        <span class="font-bold text-command-cyan"
          >{{ data.projects_count }}</span
        >
      </div>
    </div>
  </div>

  {# Status grid with data display styling #}
  <div class="grid grid-cols-3 gap-2 mb-4">
    <div
      class="bg-command-darker border border-command-red/40 p-2 relative overflow-hidden group"
    >
      <div
        class="absolute inset-0 bg-command-red/5 opacity-0 group-hover:opacity-100 transition-opacity"
      ></div>
      <div class="relative">
        <div class="data-label text-command-red mb-1">Overdue</div>
        <div class="data-value text-command-red">
          {{ '%02d'|format(data.overdue_tasks|length) }}
        </div>
      </div>
      {% if data.overdue_tasks|length > 0 %}
      <div
        class="absolute top-1 right-1 w-1.5 h-1.5 bg-command-red rounded-full animate-glow-pulse"
      ></div>
      {% endif %}
    </div>
    <div
      class="bg-command-darker border border-command-cyan/40 p-2 relative overflow-hidden group"
    >
      <div
        class="absolute inset-0 bg-command-cyan/5 opacity-0 group-hover:opacity-100 transition-opacity"
      ></div>
      <div class="relative">
        <div class="data-label text-command-cyan mb-1">Today</div>
        <div class="data-value text-command-cyan">
          {{ '%02d'|format(data.today_tasks|length) }}
        </div>
      </div>
    </div>
    <div
      class="bg-command-darker border border-command-green/40 p-2 relative overflow-hidden group"
    >
      <div
        class="absolute inset-0 bg-command-green/5 opacity-0 group-hover:opacity-100 transition-opacity"
      ></div>
      <div class="relative">
        <div class="data-label text-command-green mb-1">Done</div>
        <div class="data-value text-command-green">
          {{ '%02d'|format(data.completed_today) }}
        </div>
      </div>
    </div>
  </div>

  {# Overdue tasks - Critical alerts #} {% if data.overdue_tasks %}
  <div class="mb-3">
    <div class="flex items-center gap-2 mb-2">
      <div class="w-0.5 h-3 bg-command-red"></div>
      <h3
        class="text-[0.7rem] font-bold tracking-widest text-command-red uppercase"
      >
        Critical_Priority
      </h3>
      <div
        class="flex-1 h-px bg-gradient-to-r from-command-red/40 to-transparent"
      ></div>
    </div>
    <div class="space-y-1.5 max-h-28 overflow-y-auto pr-1">
      {% for task in data.overdue_tasks[:5] %}
      <div
        class="bg-command-darker/80 border-l-2 border-command-red p-2 relative group hover:bg-command-panel/60 transition-colors"
      >
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1 min-w-0">
            <div
              class="text-[0.7rem] text-white font-medium leading-tight mb-1"
            >
              {{ task.content }}
            </div>
            {% if task.due.date %}
            <div
              class="text-[0.6rem] text-command-red/80 font-mono tracking-wider"
            >
              DUE:{{ task.due.date }}
            </div>
            {% endif %}
          </div>
          <div class="flex items-center gap-1 flex-shrink-0">
            {% if task.priority >= 2 %}
            <div
              class="w-1 h-1 bg-command-amber rounded-full motion-alert"
            ></div>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %} {# Today's tasks - Active queue #}
  <div class="flex-1 overflow-hidden flex flex-col">
    <div class="flex items-center gap-2 mb-2">
      <div class="w-0.5 h-3 bg-command-cyan"></div>
      <h3
        class="text-[0.7rem] font-bold tracking-widest text-command-cyan uppercase"
      >
        Active_Queue
      </h3>
      <div
        class="flex-1 h-px bg-gradient-to-r from-command-cyan/40 to-transparent"
      ></div>
    </div>
    {% if data.today_tasks %}
    <div class="space-y-1.5 overflow-y-auto flex-1 pr-1">
      {% for task in data.today_tasks[:data.max_tasks] %}
      <div
        class="bg-command-darker/60 border-l-2 border-command-cyan/60 p-2 relative group hover:bg-command-panel/40 hover:border-command-cyan transition-all"
      >
        <div class="flex items-start justify-between gap-2">
          <div class="flex-1 min-w-0">
            <div class="text-[0.7rem] text-white font-medium leading-tight">
              {{ task.content }}
            </div>
            {% if task.description %}
            <div
              class="text-[0.6rem] text-command-cyan/50 mt-1 truncate font-mono"
            >
              {{ task.description }}
            </div>
            {% endif %}
            <div
              class="flex items-center gap-2 mt-1 text-[0.55rem] tracking-wider"
            >
              {% if task.project_id %}
              <span class="text-command-cyan/40 uppercase"
                >{{ task.project_name }}</span
              >
              {% endif %} {% if task.due and task.due.datetime %}
              <span class="text-command-amber/60 font-mono"
                >{{ task.due.datetime }}</span
              >
              {% endif %}
            </div>
          </div>
          <div class="flex flex-col items-end gap-1 flex-shrink-0">
            {% if task.priority >= 2 %}
            <div
              class="w-1.5 h-1.5 bg-command-amber rounded-full status-indicator"
            ></div>
            {% endif %} {% if task.labels %}
            <div class="text-[0.55rem] text-command-cyan/60 font-mono">
              +{{ task.labels|length }}
            </div>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="flex-1 flex items-center justify-center">
      <div class="text-center">
        <div class="text-[0.7rem] text-command-cyan/30 tracking-widest mb-2">
          [ QUEUE_EMPTY ]
        </div>
        <div class="w-16 h-px bg-command-cyan/20 mx-auto"></div>
      </div>
    </div>
    {% endif %}
  </div>

  {# Upcoming count footer #} {% if data.upcoming_count > 0 %}
  <div class="mt-3 pt-2 border-t border-command-border">
    <div
      class="text-[0.6rem] text-command-cyan/60 text-center tracking-widest font-mono"
    >
      +{{ '%02d'|format(data.upcoming_count) }}_UPCOMING_TASKS
    </div>
  </div>
  {% endif %}
</div>
